{"version":3,"sources":["utils/cookie.ts","layout/Auth.tsx","layout/index.module.less","layout/index.tsx"],"names":["setToken","token","cookie","set","config","TOKEN_KEY","getToken","get","removeToken","remove","Auth","route","children","history","useHistory","auth","to","encodeURIComponent","window","location","origin","BASENAME","pathname","search","redirect","push","renderRouteList","routes","map","Component","component","exact","path","render","props","module","exports","MainRoutes","Routes","useMemo","businessRoutes","fallback","Loading","IndexLayout","React","useState","value","setValue","className","styles","root","mainRoot","showLabels","onChange","event","newValue","bottomNavigation","label","icon","addIcon","color","aria-label","onClick"],"mappings":"6HAAA,oIAGaA,EAAW,SAACC,GAAD,OAAmBC,IAAOC,IAAIC,IAAOC,UAAWJ,IAE3DK,EAAyB,kBAAMJ,IAAOK,IAAIH,IAAOC,YAAc,IAE/DG,EAAc,kBAAMN,IAAOO,OAAOL,IAAOC,a,qHCKhDK,EAA4B,SAAC,GAAyB,IAAvBC,EAAsB,EAAtBA,MAAOC,EAAe,EAAfA,SACpCC,EAAUC,cAGhB,OAAIH,EAAMI,OAAST,cAEf,cAAC,IAAD,CACEU,GAAE,oCAA+BC,mBAC/BC,OAAOC,SAASC,OACdhB,IAAOiB,SACPR,EAAQM,SAASG,SACjBT,EAAQM,SAASI,WAMvBZ,EAAMa,SACD,cAAC,IAAD,CAAUR,GAAIL,EAAMa,SAAUC,MAAI,IAGpC,mCAAGb,KAGCc,EAAkB,SAACC,GAC9B,OAAOA,EAAOC,KAAI,SAACjB,GACjB,IAAmBkB,EAAclB,EAAzBmB,UACR,OACE,cAAC,IAAD,CAEEC,MAAsB,OAAfpB,EAAMqB,KACbA,KAAMrB,EAAMqB,KACZC,OAAQ,SAACC,GAAD,OACN,cAACxB,EAAD,2BAAUwB,GAAV,IAAiBvB,MAAOA,EAAxB,SACE,cAACkB,EAAD,eAAeK,SALdvB,EAAMqB,W,oBCxCnBG,EAAOC,QAAU,CAAC,KAAO,oBAAoB,SAAW,wBAAwB,iBAAmB,gCAAgC,QAAU,yB,8MC6D7I,SAASC,IACP,IAAMC,EAASC,mBAAQ,kBAAMb,YAAgBc,OAAiB,IAE9D,OACE,cAAC,WAAD,CAAUC,SAAUC,cAApB,SACE,cAAC,IAAD,UAASJ,MAPAK,UA7Ce,WAC5B,IAAM9B,EAAUC,cAChB,EAA0B8B,IAAMC,SAAShC,EAAQM,SAASG,UAA1D,mBAAOwB,EAAP,KAAcC,EAAd,KAEA,OACE,sBAAKC,UAAWC,IAAOC,KAAvB,UACE,qBAAKF,UAAWC,IAAOE,SAAvB,SACE,cAACd,EAAD,MAGF,eAAC,IAAD,CACEe,YAAU,EACVN,MAAOA,EACPO,SAAU,SAACC,EAA8BC,GACvC1C,EAAQY,KAAK8B,GACbR,EAASQ,IAEXP,UAAWC,IAAOO,iBAPpB,UASE,cAAC,IAAD,CACEC,MAAM,eACNX,MAAM,cACNY,KAAM,cAAC,IAAD,MAER,cAAC,IAAD,CACEV,UAAWC,IAAOU,QAElBC,MAAM,UACNC,aAAW,MACXC,QAAS,WACPjD,EAAQY,KAAK,UANjB,SASE,cAAC,IAAD,MAEF,cAAC,IAAD,CACEgC,MAAM,eACNX,MAAM,iBACNY,KAAM,cAAC,IAAD","file":"static/js/15.ed37456f.chunk.js","sourcesContent":["import cookie from \"js-cookie\";\nimport config from \"../config\";\n\nexport const setToken = (token: string) => cookie.set(config.TOKEN_KEY, token);\n\nexport const getToken: () => string = () => cookie.get(config.TOKEN_KEY) || \"\";\n\nexport const removeToken = () => cookie.remove(config.TOKEN_KEY);\n","import { Redirect, useHistory } from \"react-router-dom\";\nimport { IRoute } from \"../router/router\";\nimport { getToken } from \"../utils/cookie\";\nimport config from \"../config/index\";\nimport { memo } from \"react\";\nimport { Route } from \"react-router-dom\";\n\nexport interface AuthProps {\n  route: IRoute;\n  children: React.ReactNode;\n}\n\nconst Auth: React.FC<AuthProps> = ({ route, children }) => {\n  const history = useHistory();\n\n  // 需要登陆且未登陆\n  if (route.auth && !getToken()) {\n    return (\n      <Redirect\n        to={`/system/login?redirectURL=${encodeURIComponent(\n          window.location.origin +\n            config.BASENAME +\n            history.location.pathname +\n            history.location.search\n        )}`}\n      />\n    );\n  }\n\n  if (route.redirect) {\n    return <Redirect to={route.redirect} push />;\n  }\n\n  return <>{children}</>;\n};\n\nexport const renderRouteList = (routes: IRoute[]) => {\n  return routes.map((route) => {\n    const { component: Component } = route;\n    return (\n      <Route\n        key={route.path}\n        exact={route.path !== \"/*\"}\n        path={route.path}\n        render={(props) => (\n          <Auth {...props} route={route}>\n            <Component {...props} />\n          </Auth>\n        )}\n      ></Route>\n    );\n  });\n};\n\nexport default memo(Auth);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"index_root__1Gwro\",\"mainRoot\":\"index_mainRoot__30TkD\",\"bottomNavigation\":\"index_bottomNavigation__KrIsr\",\"addIcon\":\"index_addIcon__3fzAu\"};","import React, { Suspense, useMemo } from \"react\";\nimport Loading from \"../components/Loading\";\nimport { Switch, useHistory } from \"react-router-dom\";\nimport { businessRoutes } from \"../router/utils\";\nimport { renderRouteList } from \"./Auth\";\nimport {\n  BottomNavigationAction,\n  BottomNavigation,\n  Fab,\n} from \"@material-ui/core\";\nimport styles from \"./index.module.less\";\nimport HomeIcon from \"@material-ui/icons/Home\";\nimport AccountCircleIcon from \"@material-ui/icons/AccountCircle\";\nimport AddIcon from \"@material-ui/icons/Add\";\n\nconst IndexLayout: React.FC = () => {\n  const history = useHistory();\n  const [value, setValue] = React.useState(history.location.pathname);\n\n  return (\n    <div className={styles.root}>\n      <div className={styles.mainRoot}>\n        <MainRoutes />\n      </div>\n\n      <BottomNavigation\n        showLabels\n        value={value}\n        onChange={(event: React.ChangeEvent<{}>, newValue: string) => {\n          history.push(newValue);\n          setValue(newValue);\n        }}\n        className={styles.bottomNavigation}\n      >\n        <BottomNavigationAction\n          label=\"首页\"\n          value=\"/index/home\"\n          icon={<HomeIcon />}\n        />\n        <Fab\n          className={styles.addIcon}\n          // size=\"medium\"\n          color=\"primary\"\n          aria-label=\"add\"\n          onClick={() => {\n            history.push(\"/post\");\n          }}\n        >\n          <AddIcon />\n        </Fab>\n        <BottomNavigationAction\n          label=\"个人\"\n          value=\"/index/profile\"\n          icon={<AccountCircleIcon />}\n        />\n      </BottomNavigation>\n    </div>\n  );\n};\n\nexport default IndexLayout;\n\nfunction MainRoutes() {\n  const Routes = useMemo(() => renderRouteList(businessRoutes), []);\n\n  return (\n    <Suspense fallback={Loading()}>\n      <Switch>{Routes}</Switch>\n    </Suspense>\n  );\n}\n"],"sourceRoot":""}